<style>
  .testimonials-carousel-section-lumaa {
    position: relative;
    overflow: hidden;
    width: 100%;
    margin: 0 auto;
  }

  .testimonials-carousel-lumaa {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .testimonials-track-lumaa {
    display: flex;
    transition: transform 0.5s ease;
   
  }

  .testimonial-slide-lumaa {
    flex: 0 0 auto;
    
  }

  .testimonial-content-lumaa {
    display: flex;
    flex-direction: row;
    align-items: stretch;
    width: 100%;
    max-height: 600px; 
  }

  .testimonial-text-container-lumaa {
    background-color: {{ section.settings.background_color }};
    color: {{ section.settings.text_color }};
    padding: 30px; 
    display: flex;
    flex-direction: column;
    justify-content: center;
    width: 50%;
    overflow-y: auto; 
  }

  .testimonial-image-container-lumaa {
    width: 50%;
    overflow: hidden;
    max-height: 600px; 
  }

  .testimonial-image-lumaa {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .testimonial-heading-lumaa {
    font-size: 24px; 
    font-weight: 700;
    margin-bottom: 10px; 
    text-transform: uppercase;
  }

  .testimonial-heading-lumaa span {
    font-weight: 400;
  }

  .testimonial-stars-lumaa {
    display: flex;
    margin-bottom: 15px; 
  }

  .star-icon-lumaa {
    width: 20px;
    height: 20px;
    fill: #FFFFFF;
  }

  .testimonial-product-link-lumaa {
    color: {{ section.settings.text_color }};
    text-decoration: underline;
    font-weight: 700;
    margin-bottom: 10px; 
    display: inline-block;
    text-transform: uppercase;
  }

  .testimonial-text-lumaa {
    font-size: 15px; 
    line-height: 1.4;
    margin-bottom: 10px; 
  }

  .testimonial-author-lumaa {
    font-style: italic;
    margin-bottom: 10px;
  }

  .testimonial-cta-button-lumaa {
    background-color: {{ section.settings.button_color }};
    color: white;
    border: none;
    padding: 10px 20px; 
    font-size: 15px; 
    cursor: pointer;
    display: inline-block;
    text-align: center;
    text-decoration: none;
    transition: background-color 0.3s;
    margin-top: 5px; 
    align-self: flex-start;
    border-radius: 8px;
  }

  .testimonial-cta-button-lumaa:hover {
    opacity: 0.9;
  }

  .testimonial-navigation-lumaa {
    display: flex;
    justify-content: center;
    margin-top: 10px;
    position: absolute;
    bottom: 10px;
    left: 0;
    right: 0;
    z-index: 10;
  }

  .testimonial-dot-lumaa {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.5);
    border: none;
    margin: 0 5px;
    padding: 0;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .testimonial-dot-lumaa.active {
    background-color: white;
  }

 
  @media screen and (max-width: 767px) {
    .testimonial-content-lumaa {
      max-height: none; 
    }

    .testimonial-image-lumaa {
      border: 2px solid #FFFFFF;
    }
    
    .testimonial-content-lumaa {
      flex-direction: column-reverse;
    }

    .testimonial-stars-lumaa {
      margin-bottom: 10px;
    }

    .testimonial-text-container-lumaa,
    .testimonial-image-container-lumaa {
      width: 100%;
      max-height: none; 
    }

    .testimonial-text-container-lumaa {
      padding: 25px;
    }

    .testimonial-heading-lumaa {
      font-size: 28px;
      margin-bottom: 5px;
    }

    .testimonial-text-lumaa {
      font-size: 16px;
    }

    .testimonial-cta-button-lumaa {
      padding: 10px 30px;
      font-size: 14px;
      margin-bottom: 20px;
    }
  }
</style>

<div class="testimonials-carousel-section-lumaa">
  <div class="testimonials-carousel-lumaa" id="testimonials-carousel-lumaa">
    <div class="testimonials-track-lumaa">
      {% for block in section.blocks %}
        <div class="testimonial-slide-lumaa" data-slide="{{ forloop.index0 }}">
          <div class="testimonial-content-lumaa">
            <div class="testimonial-text-container-lumaa">
              <h2 class="testimonial-heading-lumaa">{{ section.settings.heading }}</h2>
              
              <div class="testimonial-stars-lumaa">
                {% assign rating = block.settings.rating | default: 5 %}
                {% for i in (1..rating) %}
                  <svg class="star-icon-lumaa" width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"/>
                  </svg>
                {% endfor %}
              </div>
              
              <a href="{{ block.settings.product_url }}" class="testimonial-product-link-lumaa">
                {{ block.settings.product_name }}
              </a>
              
              <div class="testimonial-text-lumaa">
                {{ block.settings.testimonial_text }}
              </div>
              
              <div class="testimonial-author-lumaa">
                - {{ block.settings.customer_name }}
              </div>
              
              {% if block.settings.cta_text != blank %}
                <a href="{{ block.settings.product_url }}" class="testimonial-cta-button-lumaa">
                  {{ block.settings.cta_text }}
                </a>
              {% endif %}
            </div>
            
            <div class="testimonial-image-container-lumaa">
              {% if block.settings.image != blank %}
                <img 
                  src="{{ block.settings.image | img_url: 'master' }}" 
                  alt="{{ block.settings.customer_name }}" 
                  class="testimonial-image-lumaa"
                  loading="lazy"
                >
              {% else %}
                {{ 'image' | placeholder_svg_tag: 'testimonial-image-lumaa placeholder' }}
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  
  <div class="testimonial-navigation-lumaa">
    {% for block in section.blocks %}
      <button 
        class="testimonial-dot-lumaa{% if forloop.first %} active{% endif %}" 
        data-slide="{{ forloop.index0 }}" 
        aria-label="Voir l'avis {{ forloop.index }}"
      ></button>
    {% endfor %}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const track = document.querySelector('.testimonials-track-lumaa');
    const slides = document.querySelectorAll('.testimonial-slide-lumaa');
    const dots = document.querySelectorAll('.testimonial-dot-lumaa');
    let currentSlide = 0;
    let isAnimating = false;
    
    
    function initCarousel() {
      
      track.style.width = (slides.length * 100) + '%';
      
      
      slides.forEach(slide => {
        slide.style.width = (100 / slides.length) + '%';
      });
      
      
      dots[0].classList.add('active');
    }
    
    
    function goToSlide(index) {
      if (isAnimating) return;
      isAnimating = true;
      
      
      currentSlide = index;
      
     
      track.style.transform = `translateX(-${index * (100 / slides.length)}%)`;
      
      
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
      
      
      setTimeout(() => {
        isAnimating = false;
      }, 500); 
    }
    
    
    initCarousel();
    
    
    dots.forEach((dot, index) => {
      dot.addEventListener('click', function() {
        goToSlide(index);
      });
    });
    
    
    if (slides.length > 1) {
     const autoplayInterval = setInterval(function() {
      if (!isAnimating) {
          const nextSlide = (currentSlide + 1) % slides.length;
          goToSlide(nextSlide);
        }
      }, 32000); 
      
      
      document.querySelector('.testimonial-navigation-lumaa').addEventListener('mouseenter', function() {
        clearInterval(autoplayInterval);
      });
    }
    
    
    let touchStartX = 0;
    let touchEndX = 0;
    
    document.querySelector('.testimonials-carousel-lumaa').addEventListener('touchstart', function(e) {
      touchStartX = e.changedTouches[0].screenX;
    }, false);
    
    document.querySelector('.testimonials-carousel-lumaa').addEventListener('touchend', function(e) {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    }, false);
    
    function handleSwipe() {
      if (touchEndX < touchStartX - 50) {
        
        const nextSlide = (currentSlide + 1) % slides.length;
        goToSlide(nextSlide);
      }
      
      if (touchEndX > touchStartX + 50) {
        
        const prevSlide = (currentSlide - 1 + slides.length) % slides.length;
        goToSlide(prevSlide);
      }
    }
  });
</script>

{% schema %}
{
  "name": "LUMA Caroussel Review",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Titre",
      "default": "LES CLIENTS PARLENT"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Style d'affichage",
      "options": [
        {
          "value": "default",
          "label": "Par défaut (Image à droite)"
        },
        {
          "value": "reversed",
          "label": "Inversé (Image à gauche)"
        }
      ],
      "default": "default"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Couleur d'arrière-plan",
      "default": "#6699cc"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Couleur du texte",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Couleur du bouton",
      "default": "#e94e91"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Avis client",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Photo du client"
        },
        {
          "type": "range",
          "id": "rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5,
          "label": "Note (étoiles)"
        },
        {
          "type": "text",
          "id": "product_name",
          "label": "Nom du produit",
          "default": "MASCARA PRIMELASH"
        },
        {
          "type": "url",
          "id": "product_url",
          "label": "Lien du produit"
        },
        {
          "type": "textarea",
          "id": "testimonial_text",
          "label": "Texte de l'avis",
          "default": "J'aime beaucoup ce produit ! Il offre une bonne définition sans paquets. C'est le meilleur produit que j'ai jamais utilisé."
        },
        {
          "type": "text",
          "id": "customer_name",
          "label": "Nom du client",
          "default": "Anne F."
        },
        {
          "type": "text",
          "id": "cta_text",
          "label": "Texte du bouton CTA",
          "default": "Voir le produit"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "LUMA Caroussel Review",
      "category": "Témoignages",
      "blocks": [
        {
          "type": "testimonial"
        },
        {
          "type": "testimonial"
        }
      ]
    }
  ]
}
{% endschema %}